# API文档

## 注：

```
File的Permission

permissions = (
    (1, '可查看'), (2, '可评论'), (3, '可修改'), (4, '可分享'), (5, 'all')
)
team_permissions = (
	(1, '成员可查看'), (2, '成员可评论'), (3, '成员可修改'), (4, '成员可分享')
)

File的type
types = (
	('team', '团队文档'), ('private', '私人文档')
)
```

## 不需要Token的API

### 1. 发送注册邮件接口

##### 描述
发送验证码到指定邮箱

##### 请求URL
` http://175.24.121.113:8000/myapp/email `

##### 请求方式
POST
##### 参数

|参数名|必选|类型|说明|
|:----    |:---|:----- |-----   |
|email |是  |string |邮箱   |

##### 返回示例

``` 
{
    "info": "发送成功",
    "code": 200
}
```
##### 返回状态码

200——成功

### 2. 发送找回密码邮件接口

##### 描述
发送验证码到指定邮箱

##### 请求URL
` http://175.24.121.113:8000/myapp/email2/ `

##### 请求方式
POST
##### 参数

|参数名|必选|类型|说明|
|:----    |:---|:----- |-----   |
|email |是  |string |邮箱   |

##### 返回示例

``` 
{
    "info": true,
    "code": 200
}
```

##### 返回状态码

200——成功

### 3.找回密码接口

##### 描述
类似于用邮箱重置密码

##### 请求URL
` http://175.24.121.113:8000/myapp/findpassword/ `
##### 请求方式
POST
##### 参数

|参数名|必选|类型|说明|
|:----    |:---|:----- |-----   |
|username |是  |string |用户名   |
|email |是  |string |邮箱   |
|password_new |是  |string |新密码   |
|code |是  |string |邮件里的验证码  |


##### 返回示例

``` 
{
    "info":  "找回成功",
    "code": 200,
},
{
    "info":  "验证码错误",
    "code": 403,
},
```

##### 返回状态码

200——成功

400——参数不完整 

403——验证码错误

### 4.用户注册接口

##### 描述

用于用户注册

注：注册之前需要先POST`http://175.24.121.113:8000/myapp/testemail`，并带上email参数，然后再post该api

##### 请求URL
- ` http://175.24.121.113:8000/myapp/register `
  
##### 请求方式
- POST 

##### 参数

|参数名|必选|类型|说明|
|:----    |:---|:----- |-----   |
|username |是  |string |用户名   |
|password |是  |string | 密码    |
|password2 |是  |string | 重复密码 |
|email     |是  |string | 邮箱    |
|phone_num     |是  |string | 手机号    |
|code |是 |string | 验证码 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": {
        "id": 13,
        "username": "刘六",
        "email": "12@12.12",
        "phone_num": "12345678911"
    }
}
```

##### 返回参数说明 

|参数名|类型|说明|
|:-----  |:-----|-----                           |
|info |string   |信息，可能成功或者失败原因  |
|code |int   |返回状态码，200 400  |
|data |dic   |注册的用户完整信息  |

##### 返回状态码

200——成功

400——参数不完整

403——验证码错误

****

### 5.用户登录接口

##### 描述

用于用户登录

##### 请求URL

- ` http://175.24.121.113:8000/myapp/login`

##### 请求方式

- POST 

##### 参数

| 参数名    | 必选 | 类型   | 说明     |
| :-------- | :--- | :----- | -------- |
| username  | 是   | string | 用户名   |
| password  | 是   | string | 密码     |

##### 返回示例 

``` 
{
    "info": "success",
    "token": "876c25860f8ce6606eb25f7dd8e1bf83",
    "code": 200,
    "data": {
        "id": 10,
        "username": "lisi",
        "email": "15@13.13",
        "phone_num": "12345678999"
    }
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明                       |
| :----- | :----- | -------------------------- |
| info   | string | 信息，可能成功或者失败原因 |
| token  | string | token信息                  |
| code   | int    | 返回状态码                 |
| data   | dic    | 登录的用户完整信息         |

##### 返回状态码

200——成功

400——参数不完整

403——用户名错误、密码错误

## 需要Token的API

### 1. 用户个人信息接口

##### 描述

用于请求用户信息或者修改用户信息

##### 请求URL
- ` http://175.24.121.113:8000/myapp/user/info `
  
##### 请求方式
- GET——用于请求用户详情信息
- POST——用于修改用户信息
**注：在POST此页面之前请先POST`http://175.24.121.113:8000/myapp/user/info`页面输入旧密码后再POST此页面**

##### 参数
GET方式

| 参数名 | 必选 | 类型 | 说明 |
| :----- | :--- | :--- | ---- |
| 无     | 无   | 无   | 无   |
POST方式

| 参数名       | 必选 | 类型   | 说明       |
| :----------- | :--- | :----- | ---------- |
| new_password | 是   | string | 新密码     |
| email        | 是   | string | 新邮箱     |
| phone_num    | 是   | string | 新电话号码 |

##### 返回示例 
POST请求和GET请求都返回详细信息，只是POST请求返回的是修改完成后用户的信息

``` 
{
    "info": "success",
    "code": 200,
    "data": {
        "id": 10,
        "username": "lisi",
        "email": "15@13.13",
        "phone_num": "12345678999"
    }
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明         |
| :----- | :----- | ------------ |
| info   | string | 返回信息     |
| code   | int    | 返回状态码   |
| data   | dic    | 返回用户信息 |

##### 返回状态码

200——成功

403——token有问题

****

### 2. 用户个人信息修改验证接口

##### 描述

用于在用户修改信息前验证其是否具有修改信息的资格

前端可在拿到数据后对相应修改信息的表单进行复现

##### 请求URL

- ` http://175.24.121.113:8000/myapp/user/modify`

##### 请求方式

- POST

##### 参数

POST方式

| 参数名       | 必选 | 类型   | 说明   |
| :----------- | :--- | :----- | ------ |
| old_password | 是   | string | 旧密码 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": {
        "id": 10,
        "username": "lisi",
        "email": "15@13.13",
        "phone_num": "12345678999"
    }
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明         |
| :----- | :----- | ------------ |
| info   | string | 返回信息     |
| code   | int    | 返回状态码   |
| data   | dic    | 返回用户信息 |

##### 返回状态码

200——成功

400——参数不完整

403——token问题、新旧密码相同

****

### 3. 用户收藏文档接口

##### 描述

用户点击收藏时使用

##### 请求URL

- ` http://175.24.121.113:8000/myapp/file/favorite`

##### 请求方式

- GET

##### 参数

| 参数名  | 必选 | 类型 | 说明                                           |
| :------ | :--- | :--- | ---------------------------------------------- |
| file_id | 是   | int  | 所收藏文档的id，可根据前端所传参数进行相应调整 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "id": 3,
            "file_id": 2,
            "person_id": 10,
            "kept_time": "2020-08-11T10:02:30.366545"
        }
    ]
}
```

```
{
    "info": "文件不存在",
    "code": 403
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明                             |
| :----- | :----- | -------------------------------- |
| info   | string | 返回信息                         |
| code   | int    | 返回状态码                       |
| data   | dic    | 返回用户收藏文档时间以及相关信息 |

##### 返回状态码

200——成功

403——token问题、已经收藏过了、文件不存在

****

### 4. 用户收藏文档接口

##### 描述

用户点击取消收藏时使用

##### 请求URL

- ` http://175.24.121.113:8000/myapp/file/cancelfavor`

##### 请求方式

- GET

##### 参数

| 参数名  | 必选 | 类型 | 说明                                             |
| :------ | :--- | :--- | ------------------------------------------------ |
| file_id | 是   | int  | 取消收藏文档的id，可根据前端所传参数进行相应调整 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "file_id": 2
        }
    ]
}
```

```
{
    "info": "文件不存在",
    "code": 403
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明                 |
| :----- | :----- | -------------------- |
| info   | string | 返回信息             |
| code   | int    | 返回状态码           |
| data   | dic    | 返回取消收藏的文档id |

##### 返回状态码

200——成功

403——token问题、已经收藏过了、文件不存在

****

### 5. 用户创建私人文档接口

##### 描述

用户自己在工作台创建的文档

##### 请求URL

- ` http://175.24.121.113:8000/myapp/file/create/pri`

##### 请求方式

- GET

##### 参数

无

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "id": 4,
            "file_title": "无标题",
            "file_content": "",
            "create_time": "2020-08-11T11:25:47.165467",
            "last_modified": "2020-08-11T11:25:47.165467",
            "modified_times": 0,
            "type": "private",
            "permission": 5,
            "team_permission": null,
            "creator_id": 10,
            "team_belong_id": null,
            "share": null
        }
    ]
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明         |
| :----- | :----- | ------------ |
| info   | string | 返回信息     |
| code   | int    | 返回状态码   |
| data   | dic    | 文档相关信息 |

默认创建的文档标题为无标题，且type为私人创建的文档，team相关属性都为null

##### 返回状态码

200——成功

403——token问题

****

### 6. 用户创建团队文档接口

##### 描述

用户自己在团队空间创建的文档

##### 请求URL

- ` http://175.24.121.113:8000/myapp/file/create/team`

##### 请求方式

- GET

##### 参数

| 参数名  | 必选 | 类型 | 说明                             |
| :------ | :--- | :--- | -------------------------------- |
| team_id | 是   | int  | 当前团队空间的id，可根据情况调整 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "id": 4,
            "file_title": "无标题",
            "file_content": "",
            "create_time": "2020-08-11T11:25:47.165467",
            "last_modified": "2020-08-11T11:25:47.165467",
            "modified_times": 0,
            "type": "team",
            "permission": 5,
            "team_permission": 5,
            "creator_id": 10,
            "team_belong_id": 1,
            "share": null
        }
    ]
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明         |
| :----- | :----- | ------------ |
| info   | string | 返回信息     |
| code   | int    | 返回状态码   |
| data   | dic    | 文档相关信息 |

默认创建的文档标题为无标题，且type为团队创建的文档，team相关属性都对应

##### 返回状态码

200——成功

403——token问题

****

### 7. 用户创建团队空间接口

##### 描述

用户创建团队空间

##### 请求URL

- ` http://175.24.121.113:8000/myapp/team/create/`

##### 请求方式

- POST

##### 参数

| 参数名    | 必选 | 类型   | 说明             |
| :-------- | :--- | :----- | ---------------- |
| team_name | 是   | string | 创建的团队空间名 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "id": 2,
            "creator_id": 10,
            "name": "wo are a team",
            "create_time": "2020-08-11T11:40:41.492048"
        }
    ]
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明         |
| :----- | :----- | ------------ |
| info   | string | 返回信息     |
| code   | int    | 返回状态码   |
| data   | dic    | 团队相关信息 |

##### 返回状态码

200——成功

403——token问题

****

### 8. 用户加入团队空间接口

##### 描述

用户加入团队空间

##### 请求URL

- ` http://175.24.121.113:8000/myapp/team/join/`

##### 请求方式

- GET

##### 参数

| 参数名  | 必选 | 类型 | 说明             |
| :------ | :--- | :--- | ---------------- |
| team_id | 是   | int  | 想要加入的团队id |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "id": 1,
            "team_id": 2,
            "member_id": 10,
            "join_time": "2020-08-11T14:37:58.355800",
            "permission": 5
        }
    ]
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明             |
| :----- | :----- | ---------------- |
| info   | string | 返回信息         |
| code   | int    | 返回状态码       |
| data   | dic    | 加入团队相关信息 |

##### 返回状态码

200——成功

400——参数不完整

403——token问题

****

### 9. 用户退出团队空间接口

##### 描述

用户退出团队空间

##### 请求URL

- ` http://175.24.121.113:8000/myapp/team/exit/`

##### 请求方式

- GET

##### 参数

| 参数名  | 必选 | 类型 | 说明             |
| :------ | :--- | :--- | ---------------- |
| team_id | 是   | int  | 想要加入的团队id |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": [
        {
            "team_id": 2,
        }
    ]
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明             |
| :----- | :----- | ---------------- |
| info   | string | 返回信息         |
| code   | int    | 返回状态码       |
| data   | dic    | 退出团队相关信息 |

##### 返回状态码

200——成功

400——参数不完整

403——token问题，未加入团队就退出

****

### 10. 用户评论文档

##### 描述

用户评论文档

##### 请求URL

- ` http://175.24.121.113:8000/myapp/file/comment/`

##### 请求方式

- POST

##### 参数

| 参数名  | 必选 | 类型   | 说明                         |
| :------ | :--- | :----- | ---------------------------- |
| comment | 是   | string | 评论内容                     |
| file_id | 是   | int    | 评论文档的id，可根据要求调整 |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
    "data": {
        "id": 17,
        "username": "lisi",
        "content": "this is a comment2",
        "create_time": "2020-08-11T15:55:23.905675",
        "person": 10,
        "file": 2
    }
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明                   |
| :----- | :----- | ---------------------- |
| info   | string | 返回信息               |
| code   | int    | 返回状态码             |
| data   | dic    | 评论相关信息以及评论人 |

##### 返回状态码

200——成功

400——参数不完整

403——token问题

### 11. 把文件添加到回收站 or 从回收站恢复

##### 描述

是否在回收站

##### 请求URL

- ` http://175.24.121.113:8000/file/isdelete`

##### 请求方式

- POSt

##### 参数

| 参数名  | 必选 | 类型 | 说明             |
| :------ | :--- | :--- | ---------------- |
| file_id | 是   | int  | 文件id |
| is_delete | 是   | Boolean  | True为回收，False为恢复  |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明             |
| :----- | :----- | ---------------- |
| info   | string | 返回信息         |
| code   | int    | 返回状态码       |

##### 返回状态码

200——成功
403——token问题或者文件不存在


### 12. 从回收站中彻底删除文件

##### 描述

这次文件真的没了

##### 请求URL

- ` http://175.24.121.113:8000/file/realdelete`

##### 请求方式

- POSt

##### 参数

| 参数名  | 必选 | 类型 | 说明             |
| :------ | :--- | :--- | ---------------- |
| file_id | 是   | int  | 想要加入的团队id |

##### 返回示例 

``` 
{
    "info": "success",
    "code": 200,
}
```

##### 返回参数说明 

| 参数名 | 类型   | 说明             |
| :----- | :----- | ---------------- |
| info   | string | 返回信息         |
| code   | int    | 返回状态码       |

##### 返回状态码

200——成功
403——token问题或者文件不存在